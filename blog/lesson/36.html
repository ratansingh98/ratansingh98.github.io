<!DOCTYPE html>
<html>

<head>
  <title>Background Subtraction</title>
  <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,minimum-scale=1">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link href="https://fonts.googleapis.com/css?family=Ubuntu:400,500,700,300&amp;subset=latin-ext" rel="stylesheet" type="text/css">
  <link href="../css/bundle.css" rel="stylesheet" type="text/css">
  <link href="../css/blog-theme.css" rel="stylesheet" type="text/css">
  <link href="../css/blog-common.css" rel="stylesheet" type="text/css">
  <link href="../icons/css/font-awesome.min.css" rel="stylesheet" type="text/css">
  <link rel="shortcut-icon" href="/assets/icons/favicon.ico">
  <link rel="icon" href="../icons/logo.png"></head>

<body>
  <div data-blog-nav><nav class="blog-solid-nav"><div class="blog-solid-nav__inner"><a href="/index.html" class="blog-solid-nav__brand">Grandmaster.dev</a><a href="/about.html" class="blog-solid-nav__link">About</a><a href="/blog/index.html" class="blog-solid-nav__link is-active">Blog</a><a href="/contact.html" class="blog-solid-nav__link">Contact</a></div></nav></div>
  <div data-blog-banner></div>
  <section class="section-about">
    <div class="container">
      <h2>Background Subtraction</h2>
      <p>Background subtraction is a major preprocessing step in many vision-based applications.
         For example, consider the case of a visitor counter where a static camera takes the number of visitors entering or leaving the room, or a traffic camera extracting information about the vehicles etc.
          In all these cases, first you need to extract the person or vehicles alone.
        Technically, you need to extract the moving foreground from static background.</p>
        <p>If you have an image of background alone, like an image of the room without visitors, image of the road without vehicles etc, it is an easy job. Just subtract the new image from the background. You get the foreground objects alone. But in most of the cases, you may not have such an image, so we need to extract the background from whatever images we have. It becomes more complicated when there are shadows of the vehicles. Since shadows also move, simple subtraction will mark that also as foreground. It complicates things.</p>
        <p>Several algorithms were introduced for this purpose.
          OpenCV has implemented three such algorithms which are very easy to use. We will see them one-by-one.</p>
        <p>Before starting <a href="https://github.com/ratansingh98/100_Days_of_ML_Code_Continued/blob/master/Days/mastering%20opencv%202/6.%20Motion%20Analysis%20and%20Object%20Tracking/walking.avi?raw=true" style="color:blue;">Download Avi</a></p><br>



      <h3>Gaussian Mixture-based Background/Foreground Segmentation Algorithm</h3>
      <p class="line">
        # Import Necessary Libraries<br>
        <code>import numpy as np</code><br>
        <code>import cv2</code><br><br>

        <code>cap = cv2.VideoCapture('walking.avi')</code><br>

        # Initlaize background subtractor<br>
        <code>foreground_background = cv2.bgsegm.createBackgroundSubtractorMOG()</code><br><br>
        # Infinite Loop and breaks when Enter is pressed<br>
        <code>while True:</code><br>

            &nbsp;&nbsp;&nbsp;&nbsp;<code>ret, frame = cap.read()</code><br>

            &nbsp;&nbsp;&nbsp;&nbsp;# Apply background subtractor to get our foreground mask<br>
            &nbsp;&nbsp;&nbsp;&nbsp;<code>foreground_mask = foreground_background.apply(frame)</code><br>

            &nbsp;&nbsp;&nbsp;&nbsp;<code>cv2.imshow('Output', foreground_mask)</code><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<code>if cv2.waitKey(1) == 13:</code><br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>break</code><br><br>
        # Destroy All Windows and release capture instance<br>
        <code>cap.release()</code><br>
        <code>cv2.destroyAllWindows()</code><br>
      </p>

<p><b>Our Input and Output frame will look like this:</b></p>
<img src="../image/walk.jpg" height="250px"/>
<img src="../image/Smb walk.jpg" height="250px"/>
<br><br><br>


<h3>Lets Consider for Webcam</h3>
<p class="line">
  # Import Necessary Libraries<br>
  <code>import numpy as np</code><br>
  <code>import cv2</code><br><br>

  # Intialize Webcam<br>
  <code>cap = cv2.VideoCapture(0)</code><br><br>

  # Initlaize background subtractor<br>
  <code>foreground_background = cv2.bgsegm.createBackgroundSubtractorMOG()</code><br><br>
  # Infinite Loop and breaks when Enter is pressed<br>
  <code>while True:</code><br>

      &nbsp;&nbsp;&nbsp;&nbsp;<code>ret, frame = cap.read()</code><br>

      &nbsp;&nbsp;&nbsp;&nbsp;# Apply background subtractor to get our foreground mask<br>
      &nbsp;&nbsp;&nbsp;&nbsp;<code>foreground_mask = foreground_background.apply(frame)</code><br>

      &nbsp;&nbsp;&nbsp;&nbsp;<code>cv2.imshow('Output', foreground_mask)</code><br>
      &nbsp;&nbsp;&nbsp;&nbsp;<code>if cv2.waitKey(1) == 13:</code><br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>break</code><br><br>
  # Destroy All Windows and release capture instance<br>
  <code>cap.release()</code><br>
  <code>cv2.destroyAllWindows()</code><br>
</p>
<p><b>Our Output frame will look like this:</b></p>
<img src="../image/MOG.jpg" height="250px"/>
<br><br><br>


<h3>Lets See Foreground Substraction</h3>
<p class="line">
  # Import Necessary Libraries<br>
  <code>import cv2</code><br>
  <code>import numpy as np</code><br><br>

  # Initalize webacam and store first frame<br>
  <code>cap = cv2.VideoCapture(0)</code><br>
  <code>ret, frame = cap.read()</code><br><br>

  # Create a flaot numpy array with frame values<br>
  <code>average = np.float32(frame)</code><br><br>
  # Infinite Loop and breaks when Enter is pressed<br>
  <code>while True:</code><br>
      &nbsp;&nbsp;&nbsp;&nbsp;# Get webcam frame<br>
      &nbsp;&nbsp;&nbsp;&nbsp;<code>ret, frame = cap.read()</code><br>

      &nbsp;&nbsp;&nbsp;&nbsp;# 0.01 is the weight of image, play around to see how it changes<br>
      &nbsp;&nbsp;&nbsp;&nbsp;<code>cv2.accumulateWeighted(frame, average, 0.01)</code><br>

      &nbsp;&nbsp;&nbsp;&nbsp;# Scales, calculates absolute values, and converts the result to 8-bit<br>
      &nbsp;&nbsp;&nbsp;&nbsp;<code>background = cv2.convertScaleAbs(average)</code><br>

      &nbsp;&nbsp;&nbsp;&nbsp;<code>cv2.imshow('Input', frame)</code><br>
      &nbsp;&nbsp;&nbsp;&nbsp;<code>cv2.imshow('Disapearing Background', background)</code><br>

      &nbsp;&nbsp;&nbsp;&nbsp;<code>if cv2.waitKey(1) == 13:</code><br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>break</code><br><br>
# Destroy All Windows and release capture instance<br>
  <code>cv2.destroyAllWindows()</code><br>
  <code>cap.release()</code><br>
</p>
<p><b>Our Output frame will look like this:</b></p>
<img src="../image/Fsub.jpg" height="250px"/>
<img src="../image/Fsub1.jpg" height="250px"/>
<br><br><br>

<h3>Lets See Background Substraction using KKN</h3>
<p class="line">
  # Import Necessary Libraries<br>
  <code>import numpy as np</code><br>
  <code>import cv2</code><br><br>
  # Initalize webacam and store first frame<br>
  <code>cap = cv2.VideoCapture(0)</code><br><br>
  # Initlaize Kernel of ellipse of x and y values as 3 and 3 respectively<br>
  <code>kernel = cv2.getStructuringElement( cv2.MORPH_ELLIPSE,(3,3))</code><br>
  # Initlaize background subtractor KNN<br>
  <code>fgbg = cv2.createBackgroundSubtractorKNN()</code><br><br>
  # Infinite Loop and breaks when Enter is pressed<br>
  <code>while(1):</code><br>
      &nbsp;&nbsp;&nbsp;&nbsp;<code>ret, frame = cap.read()</code><br>
      &nbsp;&nbsp;&nbsp;&nbsp;# Apply Masking to frame<br>
      &nbsp;&nbsp;&nbsp;&nbsp;<code>fgmask = fgbg.apply(frame)</code><br>
      &nbsp;&nbsp;&nbsp;&nbsp;# Apply masking and kernel<br>
      &nbsp;&nbsp;&nbsp;&nbsp;<code>fgmask = cv2.morphologyEx(fgmask, cv2.MORPH_OPEN, kernel)</code><br>

      &nbsp;&nbsp;&nbsp;&nbsp;<code>cv2.imshow('frame',fgmask)</code><br>

      &nbsp;&nbsp;&nbsp;&nbsp;<code>if cv2.waitKey(1) == 13:</code><br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>break</code><br><br>
  # Destroy All Windows and release capture instance<br>
  <code>cap.release()</code><br>
  <code>cv2.destroyAllWindows()</code><br>
</p>
<p><b>Our Output frame will look like this:</b></p>
<img src="../image/knn.jpg" height="250px"/>

<br><br><br>



    </div>

    <div class="pagination ">
      <a class="toggler" href="35.html">Prev</a>
      <a  class="toggler" href="soon.html">Next</a>
    </div>
  </section>
  <div data-blog-footer></div>
  <div class="google-rainbow">
    <div class="rainbow-item"></div>
    <div class="rainbow-item"></div>
    <div class="rainbow-item"></div>
    <div class="rainbow-item"></div>
  </div>
  <script src="../js/blog-layout.js"></script>
  <script src="../js/bundle.js"></script>
</body>

</html>
