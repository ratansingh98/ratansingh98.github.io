<!DOCTYPE html>
<html>

<head>
  <title>Digit Recognition</title>
  <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,minimum-scale=1">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link href="https://fonts.googleapis.com/css?family=Ubuntu:400,500,700,300&amp;subset=latin-ext" rel="stylesheet" type="text/css">
  <link href="../css/bundle.css" rel="stylesheet" type="text/css">
  <link href="../css/blog-theme.css" rel="stylesheet" type="text/css">
  <link href="../css/blog-common.css" rel="stylesheet" type="text/css">
  <link href="../icons/css/font-awesome.min.css" rel="stylesheet" type="text/css">
  <link rel="shortcut-icon" href="/assets/icons/favicon.ico">
  <link rel="icon" href="../icons/logo.png"></head>

<body>
  <div data-blog-nav><nav class="blog-solid-nav"><div class="blog-solid-nav__inner"><a href="/index.html" class="blog-solid-nav__brand">Grandmaster.dev</a><a href="/about.html" class="blog-solid-nav__link">About</a><a href="/blog/index.html" class="blog-solid-nav__link is-active">Blog</a><a href="/contact.html" class="blog-solid-nav__link">Contact</a></div></nav></div>
  <div data-blog-banner></div>
  <section class="section-about">
    <div class="container">
      <h2>Sklearn</h2>
      <p>Scikit-learn is a free software machine learning library for the Python programming language.
         It features various classification, regression and clustering algorithms including support vector machines, random forests,
          gradient boosting, k-means and DBSCAN,
        and is designed to interoperate with the Python numerical and scientific libraries NumPy and SciPy.</p>

    <h2>Train Model on MNIST dataset</h2>
    <p>The MNIST database of handwritten digits, available from this page, has a training set of 60,000 examples, and a test set of 10,000 examples. It is a subset of a larger set available from NIST. The digits have been size-normalized and centered in a fixed-size image.</p>
    <p><b> Let’s look at an code :</b></p>
    <p class="line">
      # Import the modules<br>
      <code>from sklearn.externals import joblib</code><br>
      <code>from sklearn import datasets</code><br>
      <code>from skimage.feature import hog</code><br>
      <code>from sklearn.svm import LinearSVC</code><br>
      <code>import numpy as np</code><br>
      <code>from collections import Counter</code><br><br>

      # Load the dataset<br>
      <code>dataset = datasets.fetch_mldata("MNIST Original")</code><br><br>

      # Extract the features and labels<br>
      <code>features = np.array(dataset.data, 'int16')</code><br>
      <code>labels = np.array(dataset.target, 'int')</code><br><br>

      # Extract the hog features<br>
      <code>list_hog_fd = []</code><br>
      <code>for feature in features:</code><br>
          &nbsp;&nbsp;&nbsp;&nbsp;<code>fd = hog(feature.reshape((28, 28)), orientations=9, pixels_per_cell=(14, 14), cells_per_block=(1, 1), visualise=False)</code><br>
          &nbsp;&nbsp;&nbsp;&nbsp;<code>list_hog_fd.append(fd)</code><br><br>
      <code>hog_features = np.array(list_hog_fd, 'float64')</code><br><br>

      <code>print ("Count of digits in dataset", Counter(labels))</code><br><br>

      # Create an linear SVM object<br>
      <code>clf = LinearSVC()</code><br><br>

      # Perform the training<br>
      <code>clf.fit(hog_features, labels)</code><br><br>

      # Save the classifier as pkl file<br>
      <code>joblib.dump(clf, "digits_cls.pkl", compress=3)</code><br>


    </p>
<br>
<h2>Recognize digits from image</h2>
      <p><b>Here are our input :</b></p>
      <img src="../image/photo_1.jpg" height="250px"/>
<p><b> Let’s look at an code :</b></p>

<p class="line">

# Import the modules<br>
<code>import cv2</code><br>
<code>from sklearn.externals import joblib</code><br>
<code>from skimage.feature import hog</code><br>
<code>import numpy as np</code><br><br>

# Load the classifier<br>
<code>clf = joblib.load("digits_cls.pkl")</code><br><br>

# Read the input image<br>
<code>im = cv2.imread("photo_1.jpg")</code><br><br>

# Convert to grayscale and apply Gaussian filtering<br>
<code>im_gray = cv2.cvtColor(im, cv2.COLOR_BGR2GRAY)</code><br>
<code>im_gray = cv2.GaussianBlur(im_gray, (5, 5), 0)</code><br><br>

# Threshold the image<br>
<code>ret, im_th = cv2.threshold(im_gray, 90, 255, cv2.THRESH_BINARY_INV)</code><br><br>

# Find contours in the image<br>
<code>_,ctrs, hier = cv2.findContours(im_th.copy(), cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)</code><br><br>

# Get rectangles contains each contour<br>
<code>rects = [cv2.boundingRect(ctr) for ctr in ctrs]</code><br><br>

# For each rectangular region, calculate HOG features and predict the digit using Linear SVM.<br>
<code>for rect in rects:</code><br>
    &nbsp;&nbsp;&nbsp;&nbsp;# Draw the rectangles<br>
    &nbsp;&nbsp;&nbsp;&nbsp;<code>cv2.rectangle(im, (rect[0], rect[1]), (rect[0] + rect[2], rect[1] + rect[3]), (0, 255, 0), 3)</code><br>
    &nbsp;&nbsp;&nbsp;&nbsp;# Make the rectangular region around the digit<br>
    &nbsp;&nbsp;&nbsp;&nbsp;<code>leng = int(rect[3] * 1.6)</code><br>
    &nbsp;&nbsp;&nbsp;&nbsp;<code>pt1 = int(rect[1] + rect[3] // 2 - leng // 2)</code><br>
    &nbsp;&nbsp;&nbsp;&nbsp;<code>pt2 = int(rect[0] + rect[2] // 2 - leng // 2)</code><br>
    &nbsp;&nbsp;&nbsp;&nbsp;<code>roi = im_th[pt1:pt1+leng, pt2:pt2+leng]</code><br>
    &nbsp;&nbsp;&nbsp;&nbsp;# Resize the image<br>
    &nbsp;&nbsp;&nbsp;&nbsp;<code>roi = cv2.resize(roi, (28, 28), interpolation=cv2.INTER_AREA)</code><br>
    &nbsp;&nbsp;&nbsp;&nbsp;<code>roi = cv2.dilate(roi, (3, 3))</code><br>
    &nbsp;&nbsp;&nbsp;&nbsp;# Calculate the HOG features<br>
    &nbsp;&nbsp;&nbsp;&nbsp;<code>roi_hog_fd = hog(roi, orientations=9, pixels_per_cell=(14, 14), cells_per_block=(1, 1), visualise=False)</code><br>
    &nbsp;&nbsp;&nbsp;&nbsp;<code>nbr = clf.predict(np.array([roi_hog_fd], 'float64'))</code><br>
    &nbsp;&nbsp;&nbsp;&nbsp;<code>cv2.putText(im, str(int(nbr[0])), (rect[0], rect[1]),cv2.FONT_HERSHEY_DUPLEX, 2, (0, 255, 255), 3)</code><br><br>

# Display image with output text<br>
<code>cv2.imshow("Resulting Image with Rectangular ROIs", im)</code><br>
<code>cv2.waitKey(0)</code><br>
<code>cv2.destroyAllWindows()</code><br>

</p>

<br>
<p><b>Our Output image will look like this:</b></p>
<img src="../image/Digit Recognize.png" height="250px"/>

    </div>

    <div class="pagination ">
      <a class="toggler" href="32.html">Prev</a>
      <a  class="toggler" href="34.html">Next</a>
    </div>
  </section>
  <div data-blog-footer></div>
  <div class="google-rainbow">
    <div class="rainbow-item"></div>
    <div class="rainbow-item"></div>
    <div class="rainbow-item"></div>
    <div class="rainbow-item"></div>
  </div>
  <script src="../js/blog-layout.js"></script>
  <script src="../js/bundle.js"></script>
</body>

</html>
