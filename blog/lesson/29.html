<!DOCTYPE html>
<html>

<head>
  <title>Face Feature Landmark Detection</title>
  <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,minimum-scale=1">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link href="https://fonts.googleapis.com/css?family=Ubuntu:400,500,700,300&amp;subset=latin-ext" rel="stylesheet" type="text/css">
  <link href="../css/bundle.css" rel="stylesheet" type="text/css">
  <link href="../css/blog-theme.css" rel="stylesheet" type="text/css">
  <link href="../css/blog-common.css" rel="stylesheet" type="text/css">
  <link href="../icons/css/font-awesome.min.css" rel="stylesheet" type="text/css">
  <link rel="shortcut-icon" href="/assets/icons/favicon.ico">
  <link rel="icon" href="../icons/logo.png"></head>

<body>
  <div data-blog-nav><nav class="blog-solid-nav"><div class="blog-solid-nav__inner"><a href="/index.html" class="blog-solid-nav__brand">Grandmaster.dev</a><a href="/about.html" class="blog-solid-nav__link">About</a><a href="/blog/index.html" class="blog-solid-nav__link is-active">Blog</a><a href="/contact.html" class="blog-solid-nav__link">Contact</a></div></nav></div>
  <div data-blog-banner></div>
  <section class="section-about">
    <div class="container">
      <h2>Face Feature Landmark Detection</h2>
      <p>Here we will try to obtain all the neccessary features of face using Dlib's model <b><a href="https://github.com/AKSHAYUBHAT/TensorFace/raw/master/openface/models/dlib/shape_predictor_68_face_landmarks.dat">shape_predictor_68_face_landmarks</a></b>.</p>
      <p><b>Here is our input image :</b></p>
      <img src="../image/faces.jpg" height="250px"/>
<br><br>
<p><b> Letâ€™s look at an code :</b></p>

<p class="line">
  # Import neccessary libraries<br>
  <code>import cv2</code><br>
  <code>import dlib</code><br>
  <code>import numpy</code><br><br>
  # Load shape_predictor_68_face_landmarks model<br>
  <code>PREDICTOR_PATH = 'shape_predictor_68_face_landmarks.dat'</code><br>
  # Create predictor and detector<br>
  <code>predictor = dlib.shape_predictor( PREDICTOR_PATH)</code><br>
  <code>detector = dlib.get_frontal_face_detector()</code><br><br>

  # Create Exception for TooManyFaces to ignore<br>
  <code>class TooManyFaces(Exception):</code><br>
      &nbsp;&nbsp;&nbsp;&nbsp;<code>pass</code><br><br>
  # Create Exception for NoFaces to ignore<br>
  <code>class NoFaces(Exception):</code><br>
      &nbsp;&nbsp;&nbsp;&nbsp;<code>pass</code><br><br><br>

  # This function will obtain landmarks from image which is passed as parameter to it<br>
  <code>def get_landmarks(im):</code><br>
      &nbsp;&nbsp;&nbsp;&nbsp;<code>rects = detector(im,1)</code><br>
      &nbsp;&nbsp;&nbsp;&nbsp;<code>if len(rects) > 1:</code><br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>raise TooManyFaces</code><br>
      &nbsp;&nbsp;&nbsp;&nbsp;<code>if len(rects) == 0:</code><br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>raise NoFaces</code><br>
      &nbsp;&nbsp;&nbsp;&nbsp;<code>return numpy.matrix([[p.x, p.y] for p in predictor(im, rects[0]).parts()])</code><br><br><br>

  # This Function will display landmarks on the image<br>
  <code>def annotate_landmarks(im, landmarks):</code><br>
      &nbsp;&nbsp;&nbsp;&nbsp;<code>im = im.copy()</code><br>
      &nbsp;&nbsp;&nbsp;&nbsp;# Loop through the landmark then number and circle features <br>
      &nbsp;&nbsp;&nbsp;&nbsp;<code>for idx, point in enumerate(landmarks):</code><br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>pos = (point[0,0], point[0,1])</code><br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>cv2.putText(im, str(idx), pos, cv2.FONT_HERSHEY_SCRIPT_SIMPLEX , fontScale=0.4, color=(0,0,255))</code><br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>cv2.circle(im,pos,3,color=(0,255,255))</code><br>
      &nbsp;&nbsp;&nbsp;&nbsp;# Return Marked image<br>
      &nbsp;&nbsp;&nbsp;&nbsp;<code>return im</code><br><br><br>

  # Load our image<br>
  <code>image = cv2.imread('faces.jpg')</code><br>
  # Call get_landmarks function<br>
  <code>landmarks = get_landmarks(image)</code><br>
  # Call annotate_landmarks function to obtain marked image <br>
  <code>image_with_landmarks = annotate_landmarks(image, landmarks)</code><br><br>
  # Display and write Marked image<br>
  <code>cv2.imshow('Result', image_with_landmarks)</code><br>
  <code>cv2.imwrite( 'image_with_landmarks.jpg', image_with_landmarks)</code><br>
  <code>cv2.waitKey(0)</code><br>
  <code>cv2.destroyAllWindows()</code><br>
</p>
<br>
<p><b>Our Output image will look like this:</b></p>
<img src="../image/image_with_landmarks.jpg" height="250px"/>
    </div>

    <div class="pagination ">
      <a class="toggler" href="28.html">Prev</a>
      <a  class="toggler" href="30.html">Next</a>
    </div>
  </section>
  <div data-blog-footer></div>
  <div class="google-rainbow">
    <div class="rainbow-item"></div>
    <div class="rainbow-item"></div>
    <div class="rainbow-item"></div>
    <div class="rainbow-item"></div>
  </div>
  <script src="../js/blog-layout.js"></script>
  <script src="../js/bundle.js"></script>
</body>

</html>
